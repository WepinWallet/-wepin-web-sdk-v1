function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function t(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function r(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(r=function(){return!!e})()}import{uuidv4 as i}from"@wepin/common";import{Overlay as c}from"../widget/overlay/Overlay.js";export var Widget=/*#__PURE__*/function(c){var u,s;function a(e,n,c,u,s){var l,f,p,v;return!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,a),f=o(f=a),t(l=(v=r()?Reflect.construct(f,[],o(this).constructor):f.apply(this,p))&&("object"==(v&&"undefined"!=typeof Symbol&&v.constructor===Symbol?"symbol":typeof v)||"function"==typeof v)?v:function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(this),"id",void 0),t(l,"url",void 0),t(l,"type",void 0),t(l,"isHide",void 0),t(l,"isWidgetReady",!1),t(l,"EL",void 0),t(l,"_open",void 0),l.url=e,l.id="id-".concat(i()),l.isHide=s,s||a.openOverlay(l.id),a._webview[l.id]=n,l.type=c,l.EL=u,window.addEventListener("message",l.EL),l._open=!0,l}return!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}(a,c),u=[{key:"isOpen",get:function(){return this._open}},{key:"close",value:function(){this.isHide||a.closeOverlay(this.id),window.removeEventListener("message",this.EL),this._open=!1,this.isWidgetReady=!1,this._closeWebview()}},{key:"response",value:function(e){try{this._post(e)}catch(e){console.error("Can not response message to the webview",e)}}},{key:"request",value:function(e){try{this._post(e)}catch(e){console.error("Can not send message to the webview",e)}}}],s=[{key:"getWebview",value:function(e){return a._webview[e]}},{key:"clearWebview",value:function(e){delete a._webview[e]}},{key:"clearAllWebview",value:function(){this._webview={}}}],u&&e(a.prototype,u),s&&e(a,s),a}(c);t(Widget,"_webview",{});