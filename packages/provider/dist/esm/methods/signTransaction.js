import{ethErrors as r}from"eth-rpc-errors";import{requestFactory as e}from"../utils/requestFactory.js";import{getSelectedAddress as t}from"../utils/selectedAddress.js";export var signTransaction=function(n){var o=n.wepinProvider,a=n.network;return function(n,i,s,c){if(!o._isInitialized){c(r.provider.unauthorized());return}var u=!1;Object.values(Array.isArray(n.params)?n.params[0]:n.params).forEach(function(e){e&&!e.startsWith("0x")&&(console.error("".concat(e," is not start with '0x'")),c(r.rpc.invalidParams()),u=!0)});var p=n.params[0].from;t(o.wepinStorage,o.wepinAppId,a).then(function(t){if((null==t?void 0:t.address)!==(null==p?void 0:p.toLowerCase())){c(r.provider.unauthorized());return}if(!u){var f=function(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{},n=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),n.forEach(function(e){var n;n=t[e],e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n})}return r}({account:{address:n.params[0].from,network:a}},n.params[0]);e({wepinProvider:o,network:a,req:n,res:i,next:s,end:c,command:"sign_transaction",parameter:f})}})}};