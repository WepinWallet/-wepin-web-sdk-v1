import{ethErrors as r}from"eth-rpc-errors";import{signTransactionParameterChecker as e}from"../utils/paramChecker.js";import{requestFactory as t}from"../utils/requestFactory.js";import{getSelectedAddress as n}from"../utils/selectedAddress.js";import{parsingSolanaTransaction as a}from"../utils/solanaParser.js";import{getAddress as o}from"../utils/utils.js";export var solanaSignAllTransactions=function(i){var s=i.wepinProvider,c=i.network;return function(i,p,u,f){if(!s._isInitialized){f(r.provider.unauthorized());return}var l=!1;if(!Array.isArray(Object.values(i.params))||!Object.keys(i.params).includes("transactions")||!Array.isArray(i.params.transactions)){f(r.rpc.invalidParams());return}var m=i.params.transactions.map(function(r){var e,t;return e=function(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{},n=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),n.forEach(function(e){var n;n=t[e],e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n})}return r}({},a(r)),t=t={data:r.startsWith("0x")?r:"0x"+r},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);t.push.apply(t,n)}return t})(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e});m.find(function(r){return!e(r)})&&(f(r.rpc.invalidParams()),l=!0);var d=m[0].from;n(s.wepinStorage,s.wepinAppId,c).then(function(e){if((null==e?void 0:e.address)!==o(c,d)){f(r.provider.unauthorized());return}if(!l){var n={account:{address:m[0].from,network:c},transactions:m};t({wepinProvider:s,network:c,req:i,res:p,next:u,end:f,command:"sign_all_transactions",parameter:n})}})}};