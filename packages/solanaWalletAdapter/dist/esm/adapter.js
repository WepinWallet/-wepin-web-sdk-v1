function e(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=Array(n);r<n;r++)t[r]=e[r];return t}function n(e,n,r,t,i,o,a){try{var u=e[o](a),c=u.value}catch(e){r(e);return}u.done?n(c):Promise.resolve(c).then(t,i)}function r(e){return function(){var r=this,t=arguments;return new Promise(function(i,o){var a=e.apply(r,t);function u(e){n(a,i,o,u,c,"next",e)}function c(e){n(a,i,o,u,c,"throw",e)}u(void 0)})}}function t(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function o(e,n){return(o=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}function a(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(a=function(){return!!e})()}function u(e,n){var r,t,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(r)throw TypeError("Generator is already executing.");for(;a;)try{if(r=1,t&&(i=2&o[0]?t.return:o[0]?t.throw||((i=t.return)&&i.call(t),0):t.next)&&!(i=i.call(t,o[1])).done)return i;switch(t=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,t=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=n.call(e,a)}catch(e){o=[6,e],t=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}}import{BaseMessageSignerWalletAdapter as c,isVersionedTransaction as s,WalletConnectionError as l,WalletDisconnectedError as M,WalletError as f,WalletNotConnectedError as p,WalletReadyState as d,WalletSendTransactionError as y}from"@solana/wallet-adapter-base";import{PublicKey as g}from"@solana/web3.js";import{WepinProvider as v}from"@wepin/provider-js";import{uintToHexString as j}from"./utils/util.js";export var WepinWalletName="Wepin";export var WepinSolanaWalletAdapter=/*#__PURE__*/function(n){var c;function h(e){var n,r,o,u,c;return!function(e,n){if(!(e instanceof n))throw TypeError("Cannot call a class as a function")}(this,h),o=i(o=h),t(n=(c=a()?Reflect.construct(o,[],i(this).constructor):o.apply(this,u))&&("object"==(c&&"undefined"!=typeof Symbol&&c.constructor===Symbol?"symbol":typeof c)||"function"==typeof c)?c:function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(this),"name",WepinWalletName),t(n,"url","https://app.wepin.io"),t(n,"icon","data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTEyLjE1IDIuNjkzODVDNy45MjQ5NiAyLjY5Mzg1IDQuNSA2LjExODgxIDQuNSAxMC4zNDM4QzQuNSAxMS42OTE2IDQuODU3MjYgMTIuNTM0NSA1LjQ1NDExIDE0LjA2MTlMNy44MzkzOSAxOS42NzUzQzguMTkwMjMgMjAuNjU5NCA5LjEyNTA4IDIxLjM2MzIgMTAuMjI4OSAyMS4zNjMyQzExLjI2MDEgMjEuMzYzMiAxMi4xNDc5IDIwLjc0NzEgMTIuNTQzNiAxOS44NjE0TDEzLjQ3MjEgMTcuODc2MkMxNy4wNjYgMTcuMjQ5NCAxOS44IDE0LjExNzUgMTkuOCAxMC4zNDM4QzE5Ljc5NzkgNi4xMTg4MSAxNi4zNzI5IDIuNjkzODUgMTIuMTUgMi42OTM4NVpNMTIuMTUgMTUuMzUxOUMxMi4wMDQ1IDE1LjM1MTkgMTEuODYzMyAxNS4zNDMzIDExLjcyMjEgMTUuMzMyNkwxMS43MDcyIDE1LjM2NDdMMTAuMjE4MiAxOC41NDE1TDEwLjIxNCAxOC41MzI5TDcuNzcwOTMgMTIuNzgwNUM3LjMyMzgzIDExLjY4NTIgNy4xNDE5OSAxMS4yMjc0IDcuMTQxOTkgMTAuMzQxN0M3LjE0MTk5IDcuNTc1NjQgOS4zODM5MyA1LjMzMzcgMTIuMTUgNS4zMzM3QzE0LjkxNjEgNS4zMzM3IDE3LjE1OCA3LjU3NTY0IDE3LjE1OCAxMC4zNDE3QzE3LjE1OCAxMy4xMDc4IDE0LjkxNjEgMTUuMzQ5NyAxMi4xNSAxNS4zNDk3VjE1LjM1MTlaIiBmaWxsPSIjNjQ0MEREIi8+CjxwYXRoIGQ9Ik0xMi4xNTA0IDEyLjI5NjlDMTMuMjI5MSAxMi4yOTY5IDE0LjEwMzYgMTEuNDIyNSAxNC4xMDM2IDEwLjM0MzhDMTQuMTAzNiA5LjI2NTA4IDEzLjIyOTEgOC4zOTA2MiAxMi4xNTA0IDguMzkwNjJDMTEuMDcxNyA4LjM5MDYyIDEwLjE5NzMgOS4yNjUwOCAxMC4xOTczIDEwLjM0MzhDMTAuMTk3MyAxMS40MjI1IDExLjA3MTcgMTIuMjk2OSAxMi4xNTA0IDEyLjI5NjlaIiBmaWxsPSIjNjQ0MEREIi8+Cjwvc3ZnPgo="),t(n,"supportedTransactionVersions",new Set(["legacy",0])),t(n,"_wepinProvider",void 0),t(n,"_provider",void 0),t(n,"_readyState","undefined"==typeof window||"undefined"==typeof document?d.Unsupported:d.Loadable),t(n,"_publicKey",void 0),t(n,"_connecting",void 0),t(n,"_network",void 0),t(n,"_config",void 0),n._connecting=!1,n._publicKey=null,n._wepinProvider=null,n._network=null!==(r=e.network)&&void 0!==r?r:"solana",n._config=e,n._provider=null,n}return!function(e,n){if("function"!=typeof n&&null!==n)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&o(e,n)}(h,n),c=[{key:"publicKey",get:function(){return this._publicKey}},{key:"connecting",get:function(){return this._connecting}},{key:"readyState",get:function(){return this._readyState}},{key:"signMessage",value:function(e){var n=this;return r(function(){var r,t;return u(this,function(i){switch(i.label){case 0:if(!n._provider)throw new p;return[4,null===(r=n._provider)||void 0===r?void 0:r.request({method:"signMessage",params:[n.publicKey.toBase58(),new TextDecoder().decode(e)]})];case 1:if(!(t=i.sent()))throw Error("Sign message failed");return[2,new Uint8Array(t.match(/.{1,2}/g).map(function(e){return parseInt(e,16)}))]}})})()}},{key:"signTransaction",value:function(e){var n=this;return r(function(){var r,t;return u(this,function(i){switch(i.label){case 0:if(!n._provider)throw new p;return r=s(e)?j(e.message.serialize()):j(e.serializeMessage()),[4,n._provider.request({method:"signTransaction",params:{transaction:r}})];case 1:if(!(t=i.sent()))throw Error("Sign transaction failed");return[2,t]}})})()}},{key:"sendTransaction",value:function(n,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=this;return r(function(){var r,t,a,c,l;return u(this,function(u){var M;switch(u.label){case 0:if(u.trys.push([0,5,,6]),!o._provider)throw new p;u.label=1;case 1:return(u.trys.push([1,3,,4]),r=i.signers,s(n))?((null==r?void 0:r.length)&&n.sign(r),t=j(n.message.serialize())):((null==r?void 0:r.length)&&(a=n).partialSign.apply(a,function(n){if(Array.isArray(n))return e(n)}(r)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||function(n,r){if(n){if("string"==typeof n)return e(n,void 0);var t=Object.prototype.toString.call(n).slice(8,-1);if("Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return e(n,void 0)}}(r)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),t=j(n.serializeMessage())),[4,o._provider.request({method:"signAndSendTransaction",params:{transaction:t}})];case 2:return[2,u.sent().signature];case 3:if(M=c=u.sent(),null!=f&&"undefined"!=typeof Symbol&&f[Symbol.hasInstance]?!!f[Symbol.hasInstance](M):M instanceof f)throw c;throw new y(null==c?void 0:c.message,c);case 4:return[3,6];case 5:throw l=u.sent(),o.emit("error",l),l;case 6:return[2]}})})()}},{key:"signAllTransactions",value:function(e){var n=this;return r(function(){var r;return u(this,function(t){switch(t.label){case 0:if(!n._provider)throw new p;return r=e.map(function(e){return s(e)?j(e.message.serialize()):j(e.serializeMessage())}),[4,n._provider.request({method:"signAllTransactions",params:{transactions:r}})];case 1:return[2,t.sent()]}})})()}},{key:"connect",value:function(){var e=this;return r(function(){var n,r,t,i,o,a,c,s,M,f,p,d;return u(this,function(u){switch(u.label){case 0:if(e.connecting||e.connected)return[2];if(e._connecting=!0,e._wepinProvider||(e._wepinProvider=new v({appId:e._config.appId,appKey:e._config.appKey})),null===(n=e._wepinProvider)||void 0===n?void 0:n.isInitialized())return[3,4];u.label=1;case 1:return u.trys.push([1,3,,4]),[4,null===(i=e._wepinProvider)||void 0===i?void 0:i.init({defaultCurrency:null!==(o=null===(r=e._config.attributes)||void 0===r?void 0:r.defaultCurrency)&&void 0!==o?o:"USD",defaultLanguage:null!==(a=null===(t=e._config.attributes)||void 0===t?void 0:t.defaultLanguage)&&void 0!==a?a:"en"})];case 2:return u.sent(),[3,4];case 3:throw new l(null==(c=u.sent())?void 0:c.message,c);case 4:if(e._provider)return[3,8];u.label=5;case 5:return u.trys.push([5,7,,8]),[4,null===(s=e._wepinProvider)||void 0===s?void 0:s.getProvider(e._network)];case 6:return e._provider=null!==(M=u.sent())&&void 0!==M?M:null,[3,8];case 7:throw new l(null==(f=u.sent())?void 0:f.message,f);case 8:return u.trys.push([8,10,11,12]),[4,e._provider.request({method:"connect",params:[]})];case 9:return p=new g(u.sent().publicKey),e._publicKey=p,e.emit("connect",p),[3,12];case 10:throw d=u.sent(),e.emit("error",d),d;case 11:return e._connecting=!1,[7];case 12:return[2]}})})()}},{key:"disconnect",value:function(){var e=this;return r(function(){return u(this,function(n){if(!e._provider)return[2];e._publicKey=null;try{e._wepinProvider.finalize()}catch(n){e.emit("error",new M)}return e.emit("disconnect"),[2]})})()}}],function(e,n){for(var r=0;r<n.length;r++){var t=n[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}(h.prototype,c),h}(c);