"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"default",{enumerable:!0,get:function(){return y}});var e=u(require("eventemitter2")),t=u(require("./APIResponse.js"));function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function n(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function o(e,t,r,n,o,a,i){try{var u=e[a](i),l=u.value}catch(e){r(e);return}u.done?t(l):Promise.resolve(l).then(n,o)}function a(e,t,r){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=i(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r||e):o.value}})(e,t,r||e)}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e){return e&&e.__esModule?e:{default:e}}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r,n,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var a=[],i=!0,u=!1;try{for(o=o.call(e);!(i=(r=o.next()).done)&&(a.push(r.value),!t||a.length!==t);i=!0);}catch(e){u=!0,n=e}finally{try{i||null==o.return||o.return()}finally{if(u)throw n}}return a}}(e,t)||s(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||s(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}}var y=function(e){"use strict";!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(y,e);var r,u,s=(r=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=i(y);return e=r?Reflect.construct(t,arguments,i(this).constructor):t.apply(this,arguments),e&&("object"==(e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e)||"function"==typeof e)?e:n(this)});function y(e){var t,r,o,a;return!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,y),r=n(t=s.call(this)),a=void 0,(o="baseUrl")in r?Object.defineProperty(r,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):r[o]=a,t.baseUrl=e,t}return u=[{key:"send",value:function(e,r){var n,a=this;return(n=function(){var r,n,o,i,u,l,f,s,y,p,h,b;return function(e,t){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(r)throw TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}(this,function(d){switch(d.label){case 0:var v;return r=e.url,n=e.query,o=e.method,i=e.data,u=e.headers,f=(l=c((null!=(v=FormData)&&"undefined"!=typeof Symbol&&v[Symbol.hasInstance]?!!v[Symbol.hasInstance](i):i instanceof v)?[i,{}]:["string"!=typeof i?JSON.stringify(i):i,{"Content-Type":"application/json"}],2))[0],s=l[1],y=a.baseUrl+r,[4,fetch(a.getUrlWithParams(y,n),{method:o,headers:Object.assign(u||{},s),body:f,credentials:e.withCredentials?"include":"same-origin"})];case 1:return[4,(p=d.sent()).json()];case 2:return h=d.sent(),b=a.convertHeadersToPlainObject(p.headers),[2,new t.default({data:h,status:p.status,headers:b,request:e})]}})},function(){var e=this,t=arguments;return new Promise(function(r,a){var i=n.apply(e,t);function u(e){o(i,r,a,u,l,"next",e)}function l(e){o(i,r,a,u,l,"throw",e)}u(void 0)})})()}},{key:"getUrlWithParams",value:function(e,t){if(!t)return e;var r=new URL(e);return Object.entries(t).forEach(function(e){var t=c(e,2),n=t[0],o=t[1];r.searchParams.append(n,o)}),r.toString()}},{key:"convertHeadersToPlainObject",value:function(e){var t={},r=!0,n=!1,o=void 0;try{for(var a,i=Object.keys(e)[Symbol.iterator]();!(r=(a=i.next()).done);r=!0){var u=a.value;t[u]=e.get(u)}}catch(e){n=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(n)throw o}}return t}},{key:"addListener",value:function(e,t){return a(i(y.prototype),"addListener",this).call(this,e,t)}},{key:"on",value:function(e,t,r){return a(i(y.prototype),"on",this).call(this,e,t,r)}},{key:"prependListener",value:function(e,t,r){return a(i(y.prototype),"prependListener",this).call(this,e,t,r)}},{key:"once",value:function(e,t,r){return a(i(y.prototype),"once",this).call(this,e,t,r)}},{key:"emit",value:function(e){for(var t,r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return(t=a(i(y.prototype),"emit",this)).call.apply(t,[this,e].concat(f(n)))}},{key:"emitAsync",value:function(e){for(var t,r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return(t=a(i(y.prototype),"emitAsync",this)).call.apply(t,[this,e].concat(f(n)))}}],function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(y.prototype,u),y}(e.default);