"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"default",{enumerable:!0,get:function(){return l}});var e,r=require("eth-json-rpc-middleware"),t=require("../BaseProvider.js"),n=(e=require("../const/gatewayUrl.js"))&&e.__esModule?e:{default:e},o=require("../middlewares/klay-json-rpc-wepin.js"),i=require("../utils/info.js");function u(e,r,t,n,o,i,u){try{var c=e[i](u),a=c.value}catch(e){t(e);return}c.done?r(a):Promise.resolve(a).then(n,o)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,r){return(a=Object.setPrototypeOf||function(e,r){return e.__proto__=r,e})(e,r)}var l=function(e){"use strict";!function(e,r){if("function"!=typeof r&&null!==r)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&a(e,r)}(f,e);var t,l,s=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=c(f);return e=t?Reflect.construct(r,arguments,c(this).constructor):r.apply(this,arguments),e&&("object"==(e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e)||"function"==typeof e)?e:function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(this)});function f(e){var t,i=e.network,u=e.rpcUrl,c=e.chainId,a=e.wepinProvider;!function(e,r){if(!(e instanceof r))throw TypeError("Cannot call a class as a function")}(this,f);var l=[],p=(0,o.createWepinMiddleware)({wepinProvider:a,network:i});return l.push(p),u.forEach(function(e){var t=e.url;"internal"===e.type&&(t=n.default.Gateway+e.url),l.push((0,r.createFetchMiddleware)({rpcUrl:t}))}),(t=s.call(this,{rpcMiddleware:l}))._initializeState({accounts:[],chainId:c}),t}return l=[{key:"generate",value:function(e){var r;return(r=function(){var r,t,n,o,u;return function(e,r){var t,n,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(t)throw TypeError("Generator is already executing.");for(;u;)try{if(t=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,n=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=(o=u.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=r.call(e,u)}catch(e){i=[6,e],n=0}finally{t=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}}(this,function(c){switch(c.label){case 0:return[4,(0,i.getNetworkInfoByName)(e.network,!0)];case 1:return n=(t=c.sent()).rpcUrl,o=t.chainId,u=new f({network:e.network,rpcUrl:n,chainId:o,wepinProvider:e.wepinProvider}),window.evmproviders=window.evmproviders||{},window.evmproviders[u.name]=u,window.evmproviders[u.name].selectedAddress=null===(r=e.address)||void 0===r?void 0:r.toLowerCase(),[2,u]}})},function(){var e=this,t=arguments;return new Promise(function(n,o){var i=r.apply(e,t);function c(e){u(i,n,o,c,a,"next",e)}function a(e){u(i,n,o,c,a,"throw",e)}c(void 0)})})()}}],function(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(f,l),f}(t.BaseProvider);