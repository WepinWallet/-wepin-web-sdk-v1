"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"solanaSignAllTransactions",{enumerable:!0,get:function(){return i}});var r=require("eth-rpc-errors"),e=require("../utils/paramChecker.js"),t=require("../utils/requestFactory.js"),n=require("../utils/selectedAddress.js"),a=require("../utils/solanaParser.js"),s=require("../utils/utils.js"),i=function(i){var o=i.wepinProvider,c=i.network;return function(i,u,p,l){if(!o._isInitialized){l(r.ethErrors.provider.unauthorized());return}var d=!1;if(!Array.isArray(Object.values(i.params))||!Object.keys(i.params).includes("transactions")||!Array.isArray(i.params.transactions)){l(r.ethErrors.rpc.invalidParams());return}var f=i.params.transactions.map(function(r){var e,t;return e=function(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{},n=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),n.forEach(function(e){var n;n=t[e],e in r?Object.defineProperty(r,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[e]=n})}return r}({},(0,a.parsingSolanaTransaction)(r)),t=t={data:r.startsWith("0x")?r:"0x"+r},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);t.push.apply(t,n)}return t})(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e});f.find(function(r){return!(0,e.signTransactionParameterChecker)(r)})&&(l(r.ethErrors.rpc.invalidParams()),d=!0);var b=f[0].from;(0,n.getSelectedAddress)(o.wepinStorage,o.wepinAppId,c).then(function(e){if((null==e?void 0:e.address)!==(0,s.getAddress)(c,b)){l(r.ethErrors.provider.unauthorized());return}if(!d){var n={account:{address:f[0].from,network:c},transactions:f};(0,t.requestFactory)({wepinProvider:o,network:c,req:i,res:u,next:p,end:l,command:"sign_all_transactions",parameter:n})}})}};