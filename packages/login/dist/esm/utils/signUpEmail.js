var e,r;function t(e,r,t,i,n,a,o){try{var s=e[a](o),l=s.value}catch(e){t(e);return}s.done?r(l):Promise.resolve(l).then(i,n)}function i(e){return function(){var r=this,i=arguments;return new Promise(function(n,a){var o=e.apply(r,i);function s(e){t(o,n,a,s,l,"next",e)}function l(e){t(o,n,a,s,l,"throw",e)}s(void 0)})}}function n(e,r){var t,i,n,a,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(t)throw TypeError("Generator is already executing.");for(;o;)try{if(t=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){o.label=a[1];break}if(6===a[0]&&o.label<n[1]){o.label=n[1],n=a;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(a);break}n[2]&&o.ops.pop(),o.trys.pop();continue}a=r.call(e,o)}catch(e){a=[6,e],i=0}finally{t=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}import{isErrorResponse as a,isFirebaseErrorResponse as o}from"@wepin/fetch-js";export var checkAndVerifyEmail=(e=i(function(e){var r,t,i,o,s,l,u,c,f,p,h,w,m;return n(this,function(n){switch(n.label){case 0:return r=e.isRequireVerified,t=e.email,i=e.locale,o=e.wepinFetch,s=e.wepinUrl,l=e.openWepinWallet,[4,o.wepinApi.user.checkEmailExist({email:t})];case 1:if(a(u=n.sent()))throw Error("failed check email exist");if(c=u.isEmailExist,f=u.isEmailverified,p=u.providerIds,c&&f&&p.includes("password"))throw Error("auth/existed-email");return[4,o.wepinApi.user.verify({type:"create",email:t,localeId:"ko"===i?1:"ja"===i?3:2})];case 2:if(a(h=n.sent()))throw w=h.statusCode,m="fail/send-email",400===w&&(m="invalid/email-domain"),Error(m);if(r)throw l&&(s.pathname="/signup/email/authentication",s.searchParams.set("email",t),s.searchParams.set("type","widget"),s.searchParams.set("language",i),window.open(s.toString(),"_blank")),Error("auth/email-verified");return[2,{oobReset:h.oobReset,oobVerify:h.oobVerify}]}})}),function(r){return e.apply(this,arguments)});export var signUpEmail=(r=i(function(e){var r,t,i,a,s,l,u;return n(this,function(n){switch(n.label){case 0:r=e.oobReset,t=e.oobVerify,i=e.email,a=e.password,s=e.wepinFetch,n.label=1;case 1:return n.trys.push([1,4,,5]),[4,s.wepinFirebaseApi.resetPassword(r,a,!1)];case 2:if(o(l=n.sent())||l.email.toLowerCase()!==i)throw Error("fail/reset-password");return[4,s.wepinFirebaseApi.verifyEmail(t)];case 3:if(o(u=n.sent())||u.email.toLowerCase()!==i)throw Error("fail/email-verified");return[3,5];case 4:throw Error("signUpEmail error"+n.sent().message);case 5:return[2]}})}),function(e){return r.apply(this,arguments)});