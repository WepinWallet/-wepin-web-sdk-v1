function e(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function n(e,n,t,r,i,o,u){try{var a=e[o](u),c=a.value}catch(e){t(e);return}a.done?n(c):Promise.resolve(c).then(r,i)}function t(e){return function(){var t=this,r=arguments;return new Promise(function(i,o){var u=e.apply(t,r);function a(e){n(u,i,o,a,c,"next",e)}function c(e){n(u,i,o,a,c,"throw",e)}a(void 0)})}}function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function o(e,n){return(o=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}function u(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(u=function(){return!!e})()}function a(e,n){var t,r,i,o,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(t)throw TypeError("Generator is already executing.");for(;u;)try{if(t=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,r=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!(i=(i=u.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){u=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){u.label=o[1];break}if(6===o[0]&&u.label<i[1]){u.label=i[1],i=o;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(o);break}i[2]&&u.ops.pop(),u.trys.pop();continue}o=n.call(e,u)}catch(e){o=[6,e],r=0}finally{t=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}import{BaseMessageSignerWalletAdapter as c,isVersionedTransaction as l,WalletConnectionError as s,WalletDisconnectedError as M,WalletError as f,WalletNotConnectedError as p,WalletReadyState as d,WalletSendTransactionError as y}from"@solana/wallet-adapter-base";import{PublicKey as g}from"@solana/web3.js";import{WepinProvider as v}from"@wepin/provider-js";import{uintToHexString as j}from"./utils/util.js";export var WepinWalletName="Wepin";export var WepinSolanaWalletAdapter=/*#__PURE__*/function(n){var c;function h(e){var n,t,o,a,c;return!function(e,n){if(!(e instanceof n))throw TypeError("Cannot call a class as a function")}(this,h),o=i(o=h),r(n=(c=u()?Reflect.construct(o,[],i(this).constructor):o.apply(this,a))&&("object"==(c&&"undefined"!=typeof Symbol&&c.constructor===Symbol?"symbol":typeof c)||"function"==typeof c)?c:function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(this),"name",WepinWalletName),r(n,"url","https://app.wepin.io"),r(n,"icon","data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTEyLjE1IDIuNjkzODVDNy45MjQ5NiAyLjY5Mzg1IDQuNSA2LjExODgxIDQuNSAxMC4zNDM4QzQuNSAxMS42OTE2IDQuODU3MjYgMTIuNTM0NSA1LjQ1NDExIDE0LjA2MTlMNy44MzkzOSAxOS42NzUzQzguMTkwMjMgMjAuNjU5NCA5LjEyNTA4IDIxLjM2MzIgMTAuMjI4OSAyMS4zNjMyQzExLjI2MDEgMjEuMzYzMiAxMi4xNDc5IDIwLjc0NzEgMTIuNTQzNiAxOS44NjE0TDEzLjQ3MjEgMTcuODc2MkMxNy4wNjYgMTcuMjQ5NCAxOS44IDE0LjExNzUgMTkuOCAxMC4zNDM4QzE5Ljc5NzkgNi4xMTg4MSAxNi4zNzI5IDIuNjkzODUgMTIuMTUgMi42OTM4NVpNMTIuMTUgMTUuMzUxOUMxMi4wMDQ1IDE1LjM1MTkgMTEuODYzMyAxNS4zNDMzIDExLjcyMjEgMTUuMzMyNkwxMS43MDcyIDE1LjM2NDdMMTAuMjE4MiAxOC41NDE1TDEwLjIxNCAxOC41MzI5TDcuNzcwOTMgMTIuNzgwNUM3LjMyMzgzIDExLjY4NTIgNy4xNDE5OSAxMS4yMjc0IDcuMTQxOTkgMTAuMzQxN0M3LjE0MTk5IDcuNTc1NjQgOS4zODM5MyA1LjMzMzcgMTIuMTUgNS4zMzM3QzE0LjkxNjEgNS4zMzM3IDE3LjE1OCA3LjU3NTY0IDE3LjE1OCAxMC4zNDE3QzE3LjE1OCAxMy4xMDc4IDE0LjkxNjEgMTUuMzQ5NyAxMi4xNSAxNS4zNDk3VjE1LjM1MTlaIiBmaWxsPSIjNjQ0MEREIi8+CjxwYXRoIGQ9Ik0xMi4xNTA0IDEyLjI5NjlDMTMuMjI5MSAxMi4yOTY5IDE0LjEwMzYgMTEuNDIyNSAxNC4xMDM2IDEwLjM0MzhDMTQuMTAzNiA5LjI2NTA4IDEzLjIyOTEgOC4zOTA2MiAxMi4xNTA0IDguMzkwNjJDMTEuMDcxNyA4LjM5MDYyIDEwLjE5NzMgOS4yNjUwOCAxMC4xOTczIDEwLjM0MzhDMTAuMTk3MyAxMS40MjI1IDExLjA3MTcgMTIuMjk2OSAxMi4xNTA0IDEyLjI5NjlaIiBmaWxsPSIjNjQ0MEREIi8+Cjwvc3ZnPgo="),r(n,"supportedTransactionVersions",new Set(["legacy",0])),r(n,"_wepinProvider",void 0),r(n,"_provider",void 0),r(n,"_readyState","undefined"==typeof window||"undefined"==typeof document?d.Unsupported:d.Loadable),r(n,"_publicKey",void 0),r(n,"_connecting",void 0),r(n,"_network",void 0),r(n,"_config",void 0),n._connecting=!1,n._publicKey=null,n._wepinProvider=null,n._network=null!==(t=e.network)&&void 0!==t?t:"solana",n._config=e,n._provider=null,n}return!function(e,n){if("function"!=typeof n&&null!==n)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&o(e,n)}(h,n),c=[{key:"publicKey",get:function(){return this._publicKey}},{key:"connecting",get:function(){return this._connecting}},{key:"readyState",get:function(){return this._readyState}},{key:"signMessage",value:function(e){var n=this;return t(function(){var t,r;return a(this,function(i){switch(i.label){case 0:if(!n._provider)throw new p;return[4,null===(t=n._provider)||void 0===t?void 0:t.request({method:"signMessage",params:[n.publicKey.toBase58(),new TextDecoder().decode(e)]})];case 1:if(!(r=i.sent()))throw Error("Sign message failed");return[2,new Uint8Array(r.match(/.{1,2}/g).map(function(e){return parseInt(e,16)}))]}})})()}},{key:"signTransaction",value:function(e){var n=this;return t(function(){var t,r;return a(this,function(i){switch(i.label){case 0:if(!n._provider)throw new p;return t=l(e)?j(e.message.serialize()):j(e.serializeMessage()),[4,n._provider.request({method:"signTransaction",params:{transaction:t}})];case 1:if(!(r=i.sent()))throw Error("Sign transaction failed");return[2,r]}})})()}},{key:"sendTransaction",value:function(n,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=this;return t(function(){var t,r,u,c,s;return a(this,function(a){var M;switch(a.label){case 0:if(a.trys.push([0,5,,6]),!o._provider)throw new p;a.label=1;case 1:return(a.trys.push([1,3,,4]),t=i.signers,l(n))?((null==t?void 0:t.length)&&n.sign(t),r=j(n.message.serialize())):((null==t?void 0:t.length)&&(u=n).partialSign.apply(u,function(n){if(Array.isArray(n))return e(n)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(n,t){if(n){if("string"==typeof n)return e(n,void 0);var r=Object.prototype.toString.call(n).slice(8,-1);if("Object"===r&&n.constructor&&(r=n.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return e(n,void 0)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),r=j(n.serializeMessage())),[4,o._provider.request({method:"signAndSendTransaction",params:{transaction:r}})];case 2:return[2,a.sent().signature];case 3:if(M=c=a.sent(),null!=f&&"undefined"!=typeof Symbol&&f[Symbol.hasInstance]?!!f[Symbol.hasInstance](M):M instanceof f)throw c;throw new y(null==c?void 0:c.message,c);case 4:return[3,6];case 5:throw s=a.sent(),o.emit("error",s),s;case 6:return[2]}})})()}},{key:"connect",value:function(){var e=this;return t(function(){var n,t,r,i,o,u,c,l,M,f,p,d;return a(this,function(a){switch(a.label){case 0:if(e.connecting||e.connected)return[2];if(e._connecting=!0,e._wepinProvider||(e._wepinProvider=new v({appId:e._config.appId,appKey:e._config.appKey})),null===(n=e._wepinProvider)||void 0===n?void 0:n.isInitialized())return[3,4];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,null===(i=e._wepinProvider)||void 0===i?void 0:i.init({defaultCurrency:null!==(o=null===(t=e._config.attributes)||void 0===t?void 0:t.defaultCurrency)&&void 0!==o?o:"USD",defaultLanguage:null!==(u=null===(r=e._config.attributes)||void 0===r?void 0:r.defaultLanguage)&&void 0!==u?u:"en"})];case 2:return a.sent(),[3,4];case 3:throw new s(null==(c=a.sent())?void 0:c.message,c);case 4:if(e._provider)return[3,8];a.label=5;case 5:return a.trys.push([5,7,,8]),[4,null===(l=e._wepinProvider)||void 0===l?void 0:l.getProvider(e._network)];case 6:return e._provider=null!==(M=a.sent())&&void 0!==M?M:null,[3,8];case 7:throw new s(null==(f=a.sent())?void 0:f.message,f);case 8:return a.trys.push([8,10,11,12]),[4,e._provider.request({method:"connect",params:[]})];case 9:return p=new g(a.sent().publicKey),e._publicKey=p,e.emit("connect",p),[3,12];case 10:throw d=a.sent(),e.emit("error",d),d;case 11:return e._connecting=!1,[7];case 12:return[2]}})})()}},{key:"disconnect",value:function(){var e=this;return t(function(){return a(this,function(n){if(!e._provider)return[2];e._publicKey=null;try{e._wepinProvider.finalize()}catch(n){e.emit("error",new M)}return e.emit("disconnect"),[2]})})()}}],function(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(h.prototype,c),h}(c);