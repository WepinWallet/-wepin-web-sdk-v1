import{ethErrors as r}from"eth-rpc-errors";import{signTransactionParameterChecker as a}from"../utils/paramChecker.js";import{getSelectedAddress as e}from"../utils/selectedAddress.js";import{parsingSolanaTransaction as i}from"../utils/solanaParser.js";import{getAddress as s}from"../utils/utils.js";import{sendTransaction as t}from"./sendTransaction.js";export var solanaSendTransaction=function(n){var o=n.wepinProvider,p=n.network;return function(n,d,m,u){if(!o._isInitialized){u(r.provider.unauthorized());return}var l,v,c=!1;Object.keys(n.params).includes("message")||(u(r.rpc.invalidParams()),c=!0);try{if(l=i(Object.values(n.params)[0]),void 0===l.value){var f=Object.values(n.params)[0];l.data=f.startsWith("0x")?f:"0x"+f}else a(l)||(u(r.rpc.invalidParams()),c=!0)}catch(a){u(r.rpc.invalidParams());return}var j=null!==(v=l.from)&&void 0!==v?v:"";e(o.wepinStorage,o.wepinAppId,p).then(function(a){if((null==a?void 0:a.address)!==s(p,j)){u(r.provider.unauthorized());return}c||(n.params=[l],t({wepinProvider:o,network:p})(n,d,m,u))})}};